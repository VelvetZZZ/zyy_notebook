# 📘 Scheme Fundamentals 学习笔记

> 来源：伯克利 CS61A 《Structure and Interpretation of Computer Programs》

---

## 🧠 一、表达式（Expressions）

Scheme 程序是由一系列表达式组成的，表达式可以分为两类：

### 1. 🧩 原始表达式（Primitive Expressions）

最基本的值或运算符：

- 数字：`2`, `3.3`
- 布尔值：`true`, `false`
- 运算符：`+`, `-`, `quotient`, `not` ...

### 2. 🧱 组合表达式（Combinations）

用括号包住操作符和参数，表示函数调用：

- `(quotient 10 2)` → 返回 `5`
- `(not true)` → 返回 `false`

---

## 🔁 二、语义规则（Evaluation Rules）

### ✔️ 数字是自求值的（Self-evaluating）

```scheme
> 2
2
```
### ✔️ 符号是变量名（Symbols）

如 quotient 表示 Scheme 的整数除法函数。

## 🧩 三、函数调用表达式（Call Expressions）
格式如下：
```scheme
(<operator> <operand1> <operand2> ...)
```
•操作符：函数名，例如 +, *, quotient
•操作数：可以是数字、符号、嵌套的表达式

## 🧪 四、示例讲解（Examples）
- 示例 1： 
 (quotient 10 2) ; → 5

调用 quotient，将 10 整除以 2，结果为 5。

- 示例 2（嵌套调用）：
 (quotient (+ 8 7) 5) ; → 3 
1.	(+ 8 7) → 15
2.	quotient(15, 5) → 3

- 示例 3（多重嵌套）：
步骤分析：
1.	(+ 2 4) → 6
2.	(* 3 6) → 18
3.	(+ 3 5) → 8
4.	(- 10 7) → 3
5.	(+ 18 8 3 6) → 35 

## 📌 五、语法提示（Syntax Notes）
✅ 表达式使用 前缀记法（operator 写在前）
✅ 使用圆括号表示函数调用（不能省略）
✅ 表达式可以 跨行 书写，空格与换行 不影响求值
❌ 不要漏括号，括号必须匹配完整！

## 核心语法：前缀表示法(Prefix Notation)
- 在我们常见的语言 (如 Java, Python) 中，我们使用中缀表示法：3 < 5 (操作符在中间)。

- 在 Scheme 中，操作符永远在最前面，并用括号括起来：(< 3 5)。


# 🧠 Scheme Special Forms 学习笔记

## 🌟 什么是 Special Form（特殊形式）？

> 在 Scheme 中，**不是函数调用的表达式就是特殊形式**（special form）。

特殊形式不会一开始就对所有参数求值，而是根据语法规则选择性地求值。例如 `if` 只会求值其中一个分支。

---

## ✅ 常见的 Special Forms

### 1. `if` 表达式（条件判断）

```scheme
(if <predicate> <consequent> <alternative>)
```
(if <测试条件> <条件为真时的返回值> <条件为假时的返回值>)

语义解释：
•	先判断 <predicate> 条件是否为真
•	如果为真，返回 <consequent>
•   否则，返回 <alternative>
📌 只会执行其中一个分支！
例子：
```scheme
(if (< 3 5) 1 2)   ; 返回 1
```

•解释：
<测试条件>: (< 3 5)
这本身也是一个表达式。
它的意思是 "判断 3 是否小于 5"。
这个判断的结果是 真 (True)。
<条件为真时的返回值>: 1
如果 <测试条件> 的结果是真，整个 if 表达式就返回这个值。
<条件为假时的返回值>: 2
如果 <测试条件> 的结果是假，整个 if 表达式就返回这个值。

## 2. and / or（逻辑运算）

- `(and e1 e2 e3 ...)`：从左到右求值，遇到第一个“假”就返回
- `(or e1 e2 e3 ...)`：从左到右求值，遇到第一个“真”就返回

📌 **都具有短路特性**（short-circuit evaluation）

---

## 3. define（定义常量 / 函数）

### 📌 定义常量（绑定符号）：

```scheme
(define pi 3.14)
(* pi 2)    ; 6.28
```
说明：
•	define 将符号 pi 与值 3.14 绑定
•	后续可以像变量一样使用 pi

## 📌 定义函数（新过程）：
```scheme
(define (abs x)
  (if (< x 0)
      (- x)
      x))
```
•	定义了一个函数 abs，接受一个参数 x
•	如果 x 小于 0，返回 -x（即取相反数）
•	否则返回 x 本身

调用示例：
(abs -3)   ; 返回 3


# 📘 Scheme 学习笔记：实现平方根函数（Newton’s Method）
## 4. sqrt（计算平方根函数）

### 📌 使用递归与牛顿法近似计算平方根：

```scheme
(define (sqrt x)
  (define (update guess)
    (if (= (square guess) x)
        guess
        (update (average guess (/ x guess)))))
  (update 1))
```
•	该函数定义了一个内部过程 update，从猜测值 1 开始迭代
•	若 (square guess) 等于 x，返回该猜测
•	否则用 (average guess (/ x guess)) 生成新猜测继续尝试

📌 示例：
(sqrt 256) ; => 16

📌 注意：
•	由于使用的是递归判断 =，该实现只适用于整数平方根
•	如果输入不是完全平方数，会陷入无限递归
•	更健壮的写法应使用“误差范围”判断，而非精确相等


## 1. 牛顿迭代法简介（通俗解释）

📌 **用途：**  
用于**求一个数的平方根**，特别是在没有内置 `sqrt` 函数的语言中。

📌 **核心思想：**  
不断猜一个答案 → 检查猜得对不对 → 如果不对，就用新的方式猜一个更接近的。

---

### 💡 怎么猜得越来越准？

我们使用下面这个“聪明”的公式来更新猜测值：
新的猜测 = 平均值(当前猜测，x ÷ 当前猜测)

也就是：
new-guess = (guess + x / guess) / 2

这个更新方法会让猜测值很快接近真正的平方根。

---

### 🧠 举个例子（比如 x = 9）：

初始猜测 guess = 1  
1. new-guess = (1 + 9/1) / 2 = 5  
2. new-guess = (5 + 9/5) / 2 ≈ 3.4  
3. new-guess = (3.4 + 9/3.4) / 2 ≈ 3.02  
4. 再来一次 ≈ 3.0004  
5. 再来 ≈ 3.0000 ✅ 很接近真值 √9 = 3！

---

### 📎 小结：

- 每次都用新的平均值来更新猜测  
- 很快就能得到精确答案  
- Scheme、Python 等语言中都可以用这个逻辑写递归函数实现平方根求解





# Scheme 学习笔记：函数定义的核心

1. 核心概念：函数即是值 (Functions as Values)
在 Scheme (以及许多函数式编程语言) 中，函数本身就是一种数据类型，就像数字、字符串一样。它们可以被：

- 命名: 绑定到一个变量名上。

- 传递: 作为参数传给其他函数。

- 返回: 作为另一个函数的返回值。

理解这一点是掌握 Scheme 函数定义的关键。

2. 形式一：语法糖 (Syntactic Sugar)
这是最常见、最直观的函数定义方式，为了方便程序员编写和阅读而设计。

```Scheme
(define (plus4 x) (+ x 4))
```
> 解读
结构: (define (函数名 参数1 参数2 ...) 函数体)

含义: 这段代码直接定义了一个名为 plus4 的函数。

它接收一个参数 x。

它的功能是返回 x + 4 的结果。

特点: 简洁明了，是日常使用中最推荐的写法。

3. 形式二：基本形式 (Fundamental Form)
这种形式揭示了函数定义的底层原理，即“给一个匿名函数命名”。它由 define 和 lambda 两个独立的部分组合而成。

```Scheme
(define plus4 (lambda (x) (+ x 4)))
```

> 解读
为了理解它，我们把它拆成两步：

### 第一步：lambda - 创建匿名函数
代码 (lambda (x) (+ x 4)) 创建了一个匿名函数。

这个函数本身就是一个值 (value)，它的功能是接收一个参数 x 并返回 x + 4。

它被创造出来时没有名字，就像数字 100 只是一个值一样。

### 第二步：define - 给值命名
define 的核心作用是给任何值绑定一个名字。

在这里，它将 plus4 这个名字绑定到了由 lambda 创建的那个函数值上。

含义: 定义了一个名为 plus4 的变量，它的值是一个匿名函数。

4. 总结：为何两种形式等价

语法糖形式是基本形式的简写。

当 Scheme 解释器看到 (define (f x) body) 时，它会在内部自动将其转换为 (define f (lambda (x) body))。

形式	解释	类型
(define (plus4 x) (+ x 4))	“定义一个名为 plus4 的函数。”	语法糖 / 简写形式
(define plus4 (lambda (x) ...))	“定义一个名为 plus4 的变量，其值为一个匿名函数。”	基本形式 / 显式形式
核心思想: 第一个写法对人更友好，第二个写法揭示了对计算机而言的底层原理。


