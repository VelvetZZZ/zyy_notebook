# 🧠 CS61A 学习笔记：Separation of Concerns（关注点分离）

---

## 💡 什么是关注点分离（Separation of Concerns）

> 关注点分离是一种程序设计原则，旨在**将程序的不同功能或模块逻辑分离开来**，每个模块专注于处理自己的一部分问题，从而提高代码的可读性、可维护性、可测试性。

---

## 🐷 Hog 游戏项目中的关注点分离

### ✅ 模块设计

| 模块 | 职责说明 |
|------|----------|
| `hog.py` | 主要的游戏模拟器，实现游戏规则与流程逻辑（回合、得分、胜利判断） |
| `commentary.py` | 游戏事件解说模块，描述每一步变化，不影响游戏主逻辑 |
| `strategies.py` | 玩家策略模块，实现不同策略逻辑（例如使用多少骰子） |

### 📌 分离的意义

- **模拟器只管运行**：`hog.py` 不需要知道如何解说或决策，只负责规则判断。
- **解说模块不干涉游戏逻辑**：`commentary.py` 专注输出描述，可以独立测试与替换。
- **策略灵活切换**：你可以很容易替换 `strategy.py` 中的策略函数进行对比实验。

### 📍 学到的设计思想

- 将**规则实现**和**策略决策**彻底分离，结构清晰
- commentary 使用**高阶函数**实现“组合式注解”，说明关注点解耦可以增强可复用性

---

## 🐜 Ants 项目中的关注点分离

### ✅ 模块设计

| 模块 | 职责说明 |
|------|----------|
| `ants.py` | 定义所有角色类（蚂蚁、蜜蜂、地点等），行为逻辑封装在类中 |
| `game.py` | 控制游戏主循环、调用各角色的行为、判定游戏胜负 |
| `graphics.py`（可选） | 图形界面渲染，不影响核心逻辑 |
| `utils.py` / `strategies.py` | 实现策略参数、行为辅助函数 |

### 📌 分离的意义

- **角色行为通过类封装**：不同蚂蚁/蜜蜂种类拥有自己的方法，符合“谁的职责谁负责”
- **游戏流程和角色分离**：游戏主循环在 `game.py`，调用对象方法来运行
- **图形界面与游戏逻辑解耦**：你可以不启动 `graphics` 也能跑完游戏逻辑（便于测试）

### 📍 学到的设计思想

- OOP 强调每个类有清晰职责，例如 `ThrowerAnt` 负责攻击，`HarvesterAnt` 负责采集
- 模块化结构使调试、测试更加简单，例如你可以单独测试某一类蚂蚁功能

---

## ✨ 为什么关注点分离很重要？

| 好处 | 说明 |
|------|------|
| 🔍 易于理解 | 每个模块关注点单一，阅读时只需关注一个方面 |
| 🧪 便于测试 | 模块独立可测试（例如策略函数、角色类等） |
| 🔄 易于扩展 | 添加新策略、新蚂蚁无需修改其他模块 |
| 🔧 易于维护 | Bug 位置更明确，修改不影响其他部分 |
| 🔁 可重用性 | Commentary 或 Strategy 可以在不同项目中复用 |

---

## 📌 总结一句话

> **模块化 + 明确职责 + 控制耦合** = 更好的程序设计

---

## 🏗️ 可视化理解
```text
   [Game Logic]               [Strategy]             [Commentary]
   ┌────────────┐           ┌────────────┐          ┌──────────────┐
   │  hog.py    │  <─────▶  │ strategies │          │ commentary.py│
   └────────────┘           └────────────┘          └──────────────┘
      ▲                                                   ▲
      │                                                   │
      ▼                                                   ▼
[调用规则逻辑]                                      [记录并输出解说]

   [Game Loop]               [Classes]               [Graphics]
   ┌────────────┐           ┌────────────┐          ┌──────────────┐
   │ game.py    │  <─────▶  │   ants.py  │          │  graphics.py │
   └────────────┘           └────────────┘          └──────────────┘
   ```